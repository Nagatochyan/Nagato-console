<!DOCTYPE html>
<html lang='ja'>
<head>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta charset='utf-8'>
<meta content='width=device-width,minimum-scale=1.0' name='viewpoint'>
<meta name="generator" content="?????? HP EDITOR -1.1">
<meta name="robots" content="noindex,nofollow,noarchive">
<title>SOS D       s   </title>
<style>*{margin:0;border:0;padding:0;line-height:1.5}html{width:100%;max-width:800px;margin:1.5rem auto 0;font-size:20px}body,input{background:#404050;color:#fff;font-family:monospace}input{color:#404050;display:inline-block;width:.75em;border-radius:0;font-size:1rem}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input:focus{outline:none}span{display:inline-block;margin:0 0 1.5em}div:before{content:"YUKI.N> ";vertical-align:top}.caret:after{content:"_"}.border{border-bottom:1px solid #fff}@media(max-width:1023px){html{margin:0}body,input{font-size:1.5rem}span{margin:0 0 .5em}}.ok{background:#fff;color:#333;text-align:center;font-family:sans-serif}.yet{background:#c6e0fb;color:#72b5f8}.nf404{background:#fff;color:#000;font-family:serif;text-align:center}h1{font-weight:700;margin:0 auto 1em}hr{height:1px;width:80%;border-top:2px solid #000;margin:0 auto 20px}a{color:#333;text-decoration:none}.sml{font-size:.8rem}</style>
</head>
<body>
<main id='main'>
</main>
<script type="text/javascript">
var d    = document.getElementById('main'),
    div  = "<div><span></span></div>",
    mess = [
    "これをあなたが読んでいる時、",
    "わたしはわたしではないだろう。",
    "",
    "このメッセージが表示されたということは、",
    "そこにはあなた、わたし、涼宮ハルヒ、朝比奈みくる、",
    "古泉一樹が存在しているはずである。",
    "",
    "それが鍵。",
    "あなたは解答を見つけ出した。",
    "",
    "",
    "",
    "",
    "これは緊急脱出プログラムである。",
    "",
    "",
    "起動させる場合はエンターキーを、",
    "そうでない場合はそれ以外のキーを選択せよ。",
    "",
    "起動させた場合、",
    "あなたは時空修正の機会を得る。",
    "ただし成功は保障できない。",
    "また帰還の保障もできない。",
    "",
    "このプログラムが起動するのは一度きりである。",
    "実行ののち、消去される。",
    "",
    "非実行が選択された場合は起動せずに消去される。",
    "",
    "",
    "",
    "Ready?",
    "EOT"
    ],
    messLen   = mess.length,
    i_div     = (-1),
    i_mess    = 0,
    canType   = false,
    // delayTime = 10,
    // typeSpeed = 10;
    typeSpeed = 60,
    delayTime = 800;

    setTimeout("Main()", 5000);
    if(document.addEventListener){
        document.addEventListener("keydown" , isEnter);
    }else if(document.attachEvent){
        document.attachEvent("onkeydown" , isEnter);
    }

function Main()
{
    typing(i_mess, mess[i_mess], mess[i_mess].length, d, true, false);
}

function typing(i, str, len, targ, createDiv, canWrite)
{
    var k=0;
    if (len==0) {
        i++;
        targ.classList.remove("caret");
        setTimeout((function(){ typing(i, mess[i], mess[i].length, targ, true, false)}), delayTime);
    }else if(mess[i]=='EOT'){
        targ.classList.remove("caret");
        targ.innerHTML = targ.innerHTML.replace(/<br>$/, " <input type='number' inputmode='verbatim' autocorrect='off'>");
        clearInterval(typingWord); typingWord=null;
        ready();
    }else{

        var typingWord = setInterval((function(){

            if (createDiv) {
                d.innerHTML += div;
                targ = d.getElementsByTagName('span')[++i_div];
                targ.classList.add('caret');
                createDiv=false;
                setTimeout((function(){canWrite=true;}), delayTime);
            }else if (k>=len) {
                clearInterval(typingWord);
                targ.innerHTML += "<br>";
                i++;
                typingWord=null;
                typing(i, mess[i], mess[i].length , targ, false, true);
            }else if(canWrite){
                targ.innerHTML += str.substr(k++, 1);
            };
        }), typeSpeed);
    };
}

function ready()
{
    var targ  = d.getElementsByTagName('input')[0];
    targ.focus(); canType = true;
    var toggleCaret=setInterval((function(){
        targ.classList.toggle('border');
    }), 600);
}

function isEnter(event)
{
//    var Enter =13;
    if (!canType) return false;
    var key= event.keyCode || event.witch;
    areUready(key==13);
}

function areUready(kyon)
{
    canType = false;
    d.innerHTML = '';
    var body    = document.getElementsByTagName('body')[0];

    if(kyon)
    {
        body.classList.add('ok');

        setTimeout((function(){
            d.innerHTML += "<p>「オーケーさ、もちろん」</p>\n<p><a href='//www.haruhi.tv/' class='sml'>&copy; 2003- SOS団</a></p>";
        }), 1000);
    }else{
        body.classList.add('yet');

        d.innerHTML += "<p>また、図書館に</p>";
        setTimeout('notFound()', 3000);
    };
}

function notFound()
{
    var b = document.getElementsByTagName('body')[0];
    b.innerHTML = ''; b.classList.remove('yet');
    b.classList.add('nf404');
    setTimeout((function(){
        b.innerHTML = "<h1>404 Not found.</h1>\n<hr>\n<p><a href='//www.yukichan-anime.com/' class='sml'>&copy; 2003- ????</a></p>";
    }), 750);
}

</script>
</body>
</html>
